server:
  port: 8083

spring:
  application:
    name: alert-engine
  
  datasource:
    url: jdbc:postgresql://localhost:5433/alert_engine_db
    username: alert_user
    password: admin
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
  
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
  
  kafka:
    bootstrap-servers: localhost:9092
    consumer:
      group-id: alert-engine-group
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring.json.trusted.packages: "*"
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
      acks: all
      retries: 3
      properties:
        spring.json.add.type.headers: false
  
  data:
    redis:
      host: localhost
      port: 6379
      timeout: 2000ms

# Eureka Client Configuration
eureka:
  client:
    service-url:
      defaultZone: http://admin:admin@localhost:8761/eureka/
    register-with-eureka: true
    fetch-registry: true
  instance:
    prefer-ip-address: true
    lease-renewal-interval-in-seconds: 10
    lease-expiration-duration-in-seconds: 30

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  metrics:
    export:
      prometheus:
        enabled: true

# Application Configuration
app:
  kafka:
    topics:
      raw-spaceweather-kp: raw.spaceweather.kp
      raw-spaceweather-cme: raw.spaceweather.cme
      raw-earthquake-data: raw.earthquake.data
      raw-earthquake-alert: raw.earthquake.alert
      raw-tsunami-warning: raw.tsunami.warning
      raw-flood-alert: raw.flood.alert
      raw-waterlevel-data: raw.waterlevel.data
      alerts-critical: alerts.critical
      alerts-warning: alerts.warning
  
  alert:
    thresholds:
      kp-index:
        minor: 4.0
        moderate: 5.0
        strong: 6.0
        severe: 7.0
        extreme: 8.0
      earthquake:
        minor: 4.5
        moderate: 5.0
        major: 6.0
        critical: 7.0
        extreme: 8.0
      tsunami:
        moderate: 30
        major: 50
        critical: 70
        extreme: 90
      cme:
        moderate: 500    # km/s
        major: 1000
        critical: 1500
        extreme: 2000
      flood:
        action: ACTION
        minor: MINOR
        moderate: MODERATE
        major: MAJOR

  
  cache:
    ttl:
      alerts: 300  # 5 minutes

# Logging
logging:
  level:
    root: INFO
    com.aiscientist.alert_engine: DEBUG
    org.springframework.kafka: INFO
    org.hibernate.SQL: DEBUG
